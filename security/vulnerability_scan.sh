#!/bin/bash

echo "Scanning for Vulnerabilities...this may take a while"
echo "----------------------------------------------------"

#Run Lynis and save the report
lynis audit system --quick --no-log --no-colors > /tmp/lynis_scan_report.txt

#Check if Lynis executed successfully
if [ $? -eq 0 ]; then
    echo "Lynis scan completed successfully."
else
    echo "Error: Lynis scan failed."
    exit 1
fi

#Check if vulnerabilities were detected
if grep -q "Suggestions" /tmp/lynis_scan_report.txt; then
    echo "Vulnerabilities detected:"
    grep -A 5 "Suggestions" /tmp/lynis_scan_report.txt
else
    echo "No vulnerabilities detected."
fi

read -p "Press Enter to continue..."

#Clean up temporary files
rm /tmp/lynis_scan_report.txt

